<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculator</title>
    <link rel="stylesheet" href="calculator_style.css">
    <!-- <link rel="stylesheet" href="../style.css"> -->
</head>
<body>
    <header>
        <a href="calculator.html" class="logo">Calculator</a>
        <nav>
            <a href="\..\index.html">Back To Main</a>
        </nav>
    </header>

    <section id="calculator">
        <table>
            <tr>
                <td colspan="3">
                    <input type="text" class="calculator_input" value="0" readonly>
                </td>
                <td><button class="calculator_button special">C</button></td>
            </tr>
            <tr>
                <td><button class="calculator_button special">DEL</button></td>
                <td><button class="calculator_button special">+/-</button></td>
                <td><button class="calculator_button special">%</button></td>
                <td><button class="calculator_button special">/</button></td>
            </tr>
            <tr>
                <td><button class="calculator_button number">7</button></td>
                <td><button class="calculator_button number">8</button></td>
                <td><button class="calculator_button number">9</button></td>
                <td><button class="calculator_button special">×</button></td>
            </tr>
            <tr>
                <td><button class="calculator_button number">4</button></td>
                <td><button class="calculator_button number">5</button></td>
                <td><button class="calculator_button number">6</button></td>
                <td><button class="calculator_button special">-</button></td>
            </tr>
            <tr>
                <td><button class="calculator_button number">1</button></td>
                <td><button class="calculator_button number">2</button></td>
                <td><button class="calculator_button number">3</button></td>
                <td><button class="calculator_button special">+</button></td>
            </tr>
            <tr>
                <td><button class="calculator_button number">0</button></td>
                <td><button class="calculator_button number">00</button></td>
                <td><button class="calculator_button special">.</button></td>
                <td><button class="calculator_button special">=</button></td>
            </tr>
        </table>
    </section>

    <footer>
        <section id="get-connected">
            <p>Contact me at: <a href="mailto:example@example.com">example@example.com</a></p>
            <p>Follow me on <a href="https://instagram.com/byn.legi" target="_blank">Instagram</a> | <a href="https://github.com/bynjerl" target="_blank">GitHub</a></p>
            <div style="border-top: 2px solid white; width: 96%;"></div>
        </section>
        <br>
        <p>BynJerL &copy 2025</p>
    </footer>
    
    <script>
        function roundToPrecision(value, precision = 10) {
            return Math.round(value * Math.pow(10, precision)) / Math.pow(10, precision);
        }

        var firstNumber = null;
        var secondNumber = null;
        var operation = null;
        var result = null;

        const inputField = document.querySelector('.calculator_input');
        const numberButtons = document.querySelectorAll('.calculator_button.number');
        const specialButtons = document.querySelectorAll('.calculator_button.special');

        numberButtons.forEach(button => {
            button.addEventListener('click', () => {
                const currentValue = inputField.value;
                const clickedValue = button.textContent;

                if (currentValue === '0') {
                    if (clickedValue !== '0' && clickedValue !== '00') {
                        inputField.value = clickedValue;
                    }
                } else if (currentValue === 'Infinity' || 
                           currentValue == 'NaN') {
                    // Do Nothing
                } else if (inputField.value.length < 15) {
                    if (button.textContent === '00' && inputField.value.length === 14) {
                        inputField.value += '0';
                    } else {
                        inputField.value += button.textContent;
                    }
                }
            });
        });

        specialButtons.forEach(button => {
            button.addEventListener('click', () => {
                const clickedValue = button.textContent;

                switch (clickedValue) {
                    case 'C':
                        firstNumber = null;
                        secondNumber = null;
                        operation = null;
                        result = null;
                        inputField.value = '0';
                        break;
                    case 'DEL': 
                        if (inputField.value !== '0' &&
                            inputField.value !== 'Infinity' &&
                            inputField.value !== 'NaN'
                        ) {
                            inputField.value = inputField.value.slice(0, -1) || '0';

                            if (inputField.value === '-') {
                                inputField.value = '0';
                            }
                        }
                        break;
                    case '+':
                    case '-':
                    case '×':
                    case '%':
                    case '/':
                        firstNumber = parseFloat(inputField.value);
                        operation = clickedValue;
                        inputField.value = 0;
                        break;
                    case '=':
                        if (firstNumber !== null && operation !== null) {
                            secondNumber = parseFloat(inputField.value);
                            
                            switch (operation) {
                                case '/':
                                    result = firstNumber / secondNumber;
                                    break;
                                case '×':
                                    result = firstNumber * secondNumber;
                                    break;
                                case '%': 
                                    result = firstNumber % secondNumber;
                                    break;
                                case '+':
                                    result = firstNumber + secondNumber;
                                    break;
                                case '-':
                                    result = firstNumber - secondNumber;
                                    break;
                            }

                            result = roundToPrecision(result);

                            inputField.value = result;
                            firstNumber = result;
                            secondNumber = null;
                            operation = null;
                        }
                        break;
                    case '.':
                        if (!inputField.value.includes('.') &&
                            inputField.value !== 'Infinity' &&
                            inputField.value !== 'NaN') {
                            inputField.value += '.';
                        }
                        break;
                    case '+/-': 
                        if (inputField.value !== '0' &&
                            inputField.value !== 'NaN'
                        ) {
                            if (inputField.value.startsWith('-')) {
                                inputField.value = inputField.value.slice(1);
                            } else {
                                inputField.value = '-' + inputField.value;
                            }
                        }
                        break;
                    default:
                        console.error(`Unhandled special button: ${clickedValue}`);
                }
            })
        });
    </script>
</body>
</html>